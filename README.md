# DIGY - Dynamic Interactive Git deploY

## üåü Features

- **Multi-Environment Execution**
  - Local execution with virtual environments
  - Docker container isolation
  - Remote execution over SSH
  - JVM-based execution
  - RAM-based execution for maximum performance

- **Interactive Development**
  - Rich terminal interface
  - Code inspection with syntax highlighting
  - Interactive file selection
  - Memory usage monitoring

- **Flexible Configuration**
  - Multiple authentication methods (SQL, Web, IO, Socket)
  - Custom virtual environments
  - File attachments for execution
  - Environment-specific settings

## üöÄ Quick Start

### Basic Usage

```bash
# Run a repository locally
digy local github.com/username/repo

# Run a specific Python file from a repository
digy local github.com/username/repo script.py --arg1 value1

# Run on a remote host via SSH
digy remote user@host github.com/username/repo script.py

# Run in a Docker container
digy docker --image python:3.12 github.com/username/repo script.py
```

## üê≥ Docker Configuration

DIGY supports running projects in isolated Docker containers with RAM-based storage for maximum performance. This ensures that:
- Projects run in complete isolation
- No local filesystem changes are made
- Resources are cleaned up automatically
- Execution is as fast as possible using RAM storage

### Configuration

DIGY uses a manifest file (`digy/manifest.yml`) to configure Docker settings. You can override these settings either:
1. In the manifest file
2. Using environment variables
3. Through command-line arguments

### Volume Types

DIGY supports two types of volumes:

1. **RAM Volumes**
   - Stored in RAM for maximum speed
   - Automatically cleaned up after use
   - Size configurable in GB
   - Example: `/tmp/digy_ram`

2. **Local Volumes**
   - Mount local directories into containers
   - Can be read-only or read-write
   - Useful for:
     - Persistent data storage
     - Local development
     - Configuration files

### Usage Examples

1. **Basic Usage**
```bash
# Run a repository from GitHub
digy local github.com/pyfunc/digy

# Run with 4GB RAM
digy local --ram-size 4 github.com/pyfunc/digy
```

2. **Local File Mount**
```bash
# Mount local directory into container
digy docker --mount ./data:/app/data:ro github.com/pyfunc/digy
```

3. **Custom Docker Configuration**
```bash
# Build and run with custom Dockerfile
digy build -f Dockerfile .
digy docker --image myapp:latest github.com/pyfunc/digy

# Or in one command
digy docker --build -f Dockerfile github.com/pyfunc/digy
```

### Performance Tips

1. **RAM Size**
   - Default: 2GB (`--ram-size 2`)
   - Adjust based on project needs
   - Example: `digy local --ram-size 4 github.com/user/repo`

2. **Volume Mounts**
   - Read-only mount: `--mount ./config:/app/config:ro`
   - Read-write mount: `--mount ./data:/app/data:rw`
   - RAM disk: `--ram-disk /cache`

3. **Cleanup**
   - Automatic cleanup: `--cleanup`
   - Remove all data: `digy clean --all`
   - List resources: `digy ls`

### Environment Configuration

DIGY supports configuration through environment variables. You can create a `.env` file in your project root based on the example:

```bash
# Initialize with default configuration
digy init
```

Key environment variables:

- `DIGY_RAM_SIZE`: RAM disk size in GB (default: 1)
- `DIGY_RAM_PATH`: RAM disk mount path (default: /tmp/digy_ram)
- `DIGY_DOCKER_IMAGE`: Default Docker image (default: python:3.12-slim)
- `DIGY_LOCAL_VOLUMES`: Local volume mounts (format: host:container:mode)
- `DIGY_RAM_VOLUMES`: RAM volume mounts
- `DIGY_ENV_VARS`: Default environment variables
- `DIGY_AUTO_CLEANUP`: Automatic cleanup after execution (true/false)
- `DIGY_LOG_LEVEL`: Logging level (DEBUG, INFO, WARNING, ERROR)

Example `.env` file:
```bash
DIGY_RAM_SIZE=2
DIGY_DOCKER_IMAGE=python:3.12-slim
DIGY_LOCAL_VOLUMES=/app:/app:rw
DIGY_LOG_LEVEL=INFO
```

### Security

- All execution happens in isolated containers
- No changes are made to the host system
- RAM volumes are ephemeral
- Local mounts can be made read-only
- Environment variables can be configured per project

### Troubleshooting

1. **Not enough RAM**
   - Increase RAM size in manifest
   - Use `--ram-size` flag
   - Monitor container memory usage

2. **Volume permissions**
   - Check Docker volume permissions
   - Use `--user` flag to match UID
   - Verify mount points are accessible

3. **Resource cleanup**
   - Use `--cleanup` flag
   - Check Docker volume usage
   - Monitor RAM disk usage

## üì¶ Installation

```bash
# Install from PyPI
pip install digy

# Or install from source
git clone https://github.com/pyfunc/digy
cd digy
pip install -e .
```

### Dependencies

DIGY requires:
- Python 3.8+
- Git
- Docker (for container execution)
- SSH (for remote execution)

Install development dependencies:
```bash
pip install -e ".[dev]"
```

## üîÑ Execution Environments

DIGY supports multiple execution environments:

### 1. Local Execution
```bash
digy local github.com/username/repo
```
- Uses local Python environment
- Creates virtual environment if needed
- Supports file attachments

### 2. Remote Execution
```bash
digy remote user@host github.com/username/repo script.py
```
- Executes code on remote host via SSH
- Supports authentication
- Transfers necessary files automatically

### 3. Docker Execution
```bash
digy docker --image python:3.12 github.com/username/repo script.py
```
- Runs in isolated container
- Customizable Docker images
- Volume mounting support

### 4. JVM Execution
```bash
digy jvm github.com/username/repo script.py
```
- Executes Python code on JVM using Jython
- Java integration
- Cross-platform compatibility

## üéØ Akronim DIGY

**DIGY** = **Dynamic Interactive Git deploY**
- **Dynamic** - Dynamiczne ≈Çadowanie repozytori√≥w
- **Interactive** - Interaktywne menu z nawigacjƒÖ strza≈Çkami
- **Git** - Integracja z repozytoriami Git
- **deploY** - Deployment w izolowanych ≈õrodowiskach

## üöÄ Funkcjonalno≈õci

- ‚ö° **Szybkie ≈Çadowanie** - Pobieranie repozytori√≥w bezpo≈õrednio do pamiƒôci RAM (100MB bazowo)
- üîí **Izolowane ≈õrodowiska** - Automatyczne tworzenie virtual environment
- üéÆ **Interaktywne menu** - Nawigacja strza≈Çkami z pomocƒÖ
- üêç **Uruchamianie kodu** - Wykonywanie plik√≥w Python z wy≈õwietlaniem wynik√≥w
- üìä **ZarzƒÖdzanie pamiƒôciƒÖ** - Monitoring i kontrola u≈ºycia RAM
- üîç **Inspekcja kodu** - PrzeglƒÖdanie plik√≥w z pod≈õwietlaniem sk≈Çadni

## üì¶ Instalacja

```bash
# Instalacja z pip (gdy bƒôdzie dostƒôpne)
pip install digy

# Lub instalacja z ≈∫r√≥de≈Ç
git clone https://github.com/pyfunc/digy
cd digy
poetry install
```

## üõ†Ô∏è Advanced Usage

### Command Reference

#### `digy local` - Run Python files locally
```bash
# Basic usage
digy local github.com/username/repo script.py

# With arguments
digy local github.com/username/repo script.py --arg1 value1 --arg2 value2
```

#### `digy remote` - Run Python files on a remote host via SSH
```bash
digy remote user@host github.com/username/repo script.py
```

#### `digy docker` - Run Python files in a Docker container
```bash
digy docker --image python:3.12 github.com/username/repo script.py
```

#### `digy jvm` - Run Python files on JVM
```bash
digy jvm github.com/username/repo script.py
```

#### `digy local` - Run locally with interactive menu
```bash
digy local github.com/username/repo

# Specify branch
digy local github.com/username/repo --branch develop

# Attach local files
digy local github.com/username/repo --file config.json
```

#### Environment Management
```bash
# List available environments
digy env list

# Create new environment
digy env create myenv --python=3.10

# Activate environment
digy env activate myenv
```

```bash
# Uruchomienie w ≈õrodowisku lokalnym
digy local github.com/pyfunc/free-on-pypi

# Uruchomienie w pamiƒôci RAM (najszybsze)
digy ram github.com/pyfunc/free-on-pypi

# Uruchomienie w kontenerze Docker
digy docker github.com/pyfunc/free-on-pypi

# Dodatkowe opcje
# Z okre≈õlonƒÖ ga≈ÇƒôziƒÖ
digy local github.com/user/repo --branch develop

# Szybkie uruchomienie konkretnego pliku
digy ram github.com/pyfunc/free-on-pypi pypi.py --args "from_file"

# Status i informacje
digy status
digy info
```

## üìã Interaktywne Menu

Po za≈Çadowaniu repozytorium DIGY wy≈õwietli interaktywne menu z opcjami:

```
üìã Show Repository Info    - Informacje o repozytorium
üìñ View README            - Wy≈õwietl plik README
üîß Setup Environment      - Skonfiguruj ≈õrodowisko
üìÅ List Python Files      - Lista plik√≥w Python
üöÄ Run Python File        - Uruchom plik Python
üîç Inspect File           - Zbadaj zawarto≈õƒá pliku
üíª Interactive Shell      - Interaktywna pow≈Çoka Python
üßπ Cleanup & Exit         - Wyczy≈õƒá i wyjd≈∫
```

### Nawigacja

- **‚Üë/‚Üì** lub **j/k** - Poruszanie siƒô po menu
- **Enter** - Wyb√≥r opcji
- **1-8** - Bezpo≈õredni wyb√≥r numerem
- **q** - Wyj≈õcie

## üîß Przyk≈Çad u≈ºycia z repozytorium free-on-pypi

```python
from digy import digy

# Za≈Çaduj repozytorium lokalnie
digy.local('github.com/pyfunc/free-on-pypi')

# Lub w pamiƒôci RAM
digy.ram('github.com/pyfunc/free-on-pypi')

# Albo w Dockerze
digy.docker('github.com/pyfunc/free-on-pypi')
```

Po za≈Çadowaniu zobaczysz menu z opcjami uruchomienia:
1. `pypi.py from_file` - Sprawdzenie nazw z pliku
2. `pypi.py generator` - Generator kombinacji nazw
3. `github.py from_file` - Sprawdzenie nazw na GitHub

Ka≈ºde uruchomienie poka≈ºe:
- Pe≈Çne wyj≈õcie konsoli
- B≈Çƒôdy (je≈õli wystƒÖpiƒÖ)
- Pytanie o uruchomienie kolejnej komendy

## üéÆ Funkcje interaktywne

### Uruchamianie plik√≥w Python
- Wyb√≥r pliku z listy
- Podanie argument√≥w
- Wy≈õwietlenie pe≈Çnego wyj≈õcia
- Monitoring czasu wykonania

### Inspekcja kodu
- Pod≈õwietlanie sk≈Çadni
- Informacje o pliku (linie, rozmiar)
- Lista import√≥w
- Wykrywanie bloku `if __name__ == "__main__"`

### ZarzƒÖdzanie ≈õrodowiskiem
- Automatyczne tworzenie virtual environment
- Instalacja requirements.txt
- Instalacja pakietu w trybie deweloperskim
- Monitoring pamiƒôci RAM

## üîß Konfiguracja

### Zmienne ≈õrodowiskowe

```bash
export DIGY_MEMORY_BASE=100    # Bazowa alokacja pamiƒôci w MB
export DIGY_TIMEOUT=300        # Timeout wykonania w sekundach
```

### Programowa konfiguracja

```python
from digy.loader import memory_manager

# Zmie≈Ñ bazowƒÖ alokacjƒô pamiƒôci
memory_manager.base_size_mb = 200

# Sprawd≈∫ dostƒôpnƒÖ pamiƒôƒá
available = memory_manager.check_available_memory()
print(f"Dostƒôpne: {available} MB")
```

## üìù API Reference

### `digy(repo_url, branch='main')`
G≈Ç√≥wna funkcja ≈ÇadujƒÖca repozytorium i uruchamiajƒÖca interaktywne menu.

**Parametry:**
- `repo_url` (str): URL repozytorium (github.com/user/repo lub pe≈Çny URL)
- `branch` (str): Ga≈ÇƒÖ≈∫ do pobrania (domy≈õlnie 'main')

**Zwraca:**
- `str | None`: ≈öcie≈ºka do lokalnego repozytorium lub None przy b≈Çƒôdzie

### Klasa `Deployer`
ZarzƒÖdza deploymentem aplikacji w izolowanych ≈õrodowiskach.

### Klasa `InteractiveMenu`
Zapewnia interaktywne menu z nawigacjƒÖ strza≈Çkami.

### Klasa `MemoryManager`
ZarzƒÖdza alokacjƒÖ pamiƒôci dla za≈Çadowanych repozytori√≥w.

## üîç Przyk≈Çady zaawansowane

### Niestandardowa ≈õcie≈ºka
```python
from digy.loader import GitLoader
from digy.deployer import Deployer

loader = GitLoader("/custom/path")
local_path = loader.download_repo("github.com/user/repo")
deployer = Deployer(local_path)
```

### Programowe uruchamianie
```python
from digy import digy

# Uruchomienie z kodu Pythona
# Lokalnie
result = digy.local('github.com/user/repo', 'script.py', ['arg1', 'arg2'])

# W pamiƒôci RAM
result = digy.ram('github.com/user/repo', 'script.py', ['arg1', 'arg2'])

# W Dockerze
result = digy.docker('github.com/user/repo', 'script.py', ['arg1', 'arg2'])

# Wynik zawiera (success, stdout, stderr)
print(f"Sukces: {result[0]}")
print(f"Wyj≈õcie: {result[1]}")
if result[2]:
    print(f"B≈Çƒôdy: {result[2]}")
```

## üõ†Ô∏è Rozw√≥j

### Wymagania deweloperskie
- Python 3.8+
- Poetry
- Git

### Instalacja deweloperska
```bash
git clone https://github.com/pyfunc/digy
cd digy
poetry install
poetry run pytest
```

### Struktura projektu
```
digy/
‚îú‚îÄ‚îÄ digy/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py      # G≈Ç√≥wny modu≈Ç
‚îÇ   ‚îú‚îÄ‚îÄ loader.py        # ≈Åadowanie repozytori√≥w
‚îÇ   ‚îú‚îÄ‚îÄ deployer.py      # Deployment and execution
‚îÇ   ‚îú‚îÄ‚îÄ interactive.py   # Interactive menu
‚îÇ   ‚îú‚îÄ‚îÄ cli.py          # Command line interface
‚îÇ   ‚îú‚îÄ‚îÄ environment.py   # Environment management
‚îÇ   ‚îú‚îÄ‚îÄ auth.py         # Authentication providers
‚îÇ   ‚îî‚îÄ‚îÄ version.py      # Version information
‚îú‚îÄ‚îÄ tests/              # Tests
‚îú‚îÄ‚îÄ examples/           # Usage examples
‚îÇ   ‚îú‚îÄ‚îÄ basic/          # Basic examples
‚îÇ   ‚îú‚îÄ‚îÄ env/            # Environment examples
‚îÇ   ‚îî‚îÄ‚îÄ attachments/    # File attachment examples
‚îú‚îÄ‚îÄ pyproject.toml      # Konfiguracja Poetry
‚îî‚îÄ‚îÄ README.md          # Dokumentacja
```

## üìÑ Licencja

Apache Software License - Zobacz plik LICENSE dla szczeg√≥≈Ç√≥w.

## ü§ù Wk≈Çad

Zapraszamy do wsp√≥≈Çpracy! Prosimy o:
1. Forkowanie repozytorium
2. Tworzenie feature branch
3. Commit zmian
4. Push do branch
5. Tworzenie Pull Request

## üìû Wsparcie

- **Issues**: https://github.com/pyfunc/digy/issues
- **Email**: info@softreck.dev
- **Dokumentacja**: https://github.com/pyfunc/digy

---

**DIGY** - Tw√≥j interaktywny asystent do deploymentu aplikacji Python! üöÄ